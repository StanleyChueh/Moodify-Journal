(this["webpackJsonpdiary-image-app"]=this["webpackJsonpdiary-image-app"]||[]).push([[0],[,,,,function(e,t,a){e.exports=a(17)},,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),s=a(3),o=a.n(s),c=(a(12),a(1));a(13),a(14);var r=function(e){let{isOpen:t,onClose:a,message:n,link:s}=e;return t?l.a.createElement("div",{className:"modal-overlay"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("h2",{className:"modal-title"},"Time to Get Some Help!"),l.a.createElement("p",{className:"modal-message"},n),l.a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"modal-link"},"Visit a Psychiatrist"),l.a.createElement("button",{className:"modal-close-button",onClick:a},"Close"))):null};a(15);var i=function(e){let{isOpen:t,onClose:a,canvasRef:s,handleCanvasMouseDown:o,handleCanvasMouseMove:c,handleCanvasMouseUp:r,saveDrawing:i,reimagineDrawing:u,savedDrawing:m}=e;const[d,g]=Object(n.useState)("#000000");return Object(n.useEffect)(()=>{const e=s.current;if(e&&m){const t=e.getContext("2d"),a=new Image;a.src=m,a.onload=()=>{t.clearRect(0,0,e.width,e.height),t.drawImage(a,0,0,e.width,e.height)}}else if(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}},[t,m]),l.a.createElement("div",{className:"drawing-overlay "+(t?"active":"")},l.a.createElement("div",{className:"drawing-modal-content"},l.a.createElement("div",{className:"modal-decoration"})," ",l.a.createElement("h2",null,"Draw Your Mood"),l.a.createElement("canvas",{ref:s,className:"drawing-canvas",width:"700",height:"700",onMouseDown:o,onMouseMove:c,onMouseUp:r}),l.a.createElement("div",{className:"color-palette"},l.a.createElement("h3",null,"Select Color:"),["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FFA500","#800080","#00FFFF","#FFC0CB","#8B4513"].map((e,t)=>l.a.createElement("button",{key:t,style:{backgroundColor:e,width:"30px",height:"30px",margin:"2px",border:d===e?"2px solid #000":"1px solid #ccc",cursor:"pointer",borderRadius:"50%"},onClick:()=>(e=>{g(e);const t=s.current;if(t){t.getContext("2d").strokeStyle=e}})(e)}))),l.a.createElement("div",{className:"drawing-buttons"},l.a.createElement("button",{onClick:i},"Save"),l.a.createElement("button",{onClick:u},"Re-imagine"),l.a.createElement("button",{onClick:a},"Close"))))};a(16);var u=function(e){let{isOpen:t,onClose:a,happyDays:n,onSelectDate:s}=e;return t&&0!==n.length?l.a.createElement("div",{className:"modal-overlay"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("h2",{className:"modal-title"},"Cheer up ",l.a.createElement("span",{role:"img","aria-label":"hands"},"\ud83d\ude4c")),l.a.createElement("p",{className:"modal-message"},'"We all have tough days. Here\'s a happy memory to brighten your day!"'),l.a.createElement("div",{className:"memory-list"},n.map(e=>l.a.createElement("button",{key:e,className:"memory-button",onClick:()=>s(e)},e))),l.a.createElement("button",{className:"close-button",onClick:a},"Close"))):null};const m=["Anger","Neutral","Fear","Sadness","Surprise","Happiness"],d=["\ud83d\ude20","\ud83d\ude10","\ud83d\ude28","\ud83d\ude22","\ud83d\ude32","\ud83d\ude0a"],g={Anger:"images/Anger",Neutral:"images/Neutral",Fear:"images/Fear",Sadness:"images/Sadness",Surprise:"images/Surprise",Happiness:"images/Happiness"},p={Anger:10,Neutral:3,Fear:8,Sadness:20,Surprise:8,Happiness:11};function h(e){const t=e.match(/^.*(?:youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t&&11===t[1].length?t[1]:null}function b(){return m.reduce((e,t)=>(e[t]=0,e),{})}function E(e){let{isOpen:t,onClose:a,onSave:n,selectedMoodForPlaylist:s,setSelectedMoodForPlaylist:o,youtubeLink:c,setYoutubeLink:r}=e;return t?l.a.createElement("div",{className:"playlist-modal"},l.a.createElement("h3",null,"Customize Playlist"),l.a.createElement("label",null,"Select Mood:",l.a.createElement("select",{value:s,onChange:e=>o(e.target.value)},m.map(e=>l.a.createElement("option",{key:e,value:e},e)))),l.a.createElement("label",null,"YouTube Link:",l.a.createElement("input",{type:"url",placeholder:"Paste YouTube link here",value:c,onChange:e=>r(e.target.value)})),l.a.createElement("button",{onClick:()=>n(s,c)},"Save"),l.a.createElement("button",{onClick:a},"Cancel")):null}var v=function(){const e=function(){const e=new Date,t=[];for(let a=0;a<=30;a++){const n=new Date(e);n.setDate(e.getDate()-a);const l=n.toISOString().split("T")[0];t.push(l)}return t}(),[t,a]=Object(n.useState)(function(e){return e.reduce((e,t)=>(e[t]={description:"",mood:25,imageUrl:null},e),{})}(e)),[s,o]=Object(n.useState)(e[0]),[v,f]=Object(n.useState)(t[e[0]].description),[w,y]=Object(n.useState)(t[e[0]].speechResult),[S,C]=Object(n.useState)(25),[N,O]=Object(n.useState)(t[e[0]].imageUrl),[j,k]=Object(n.useState)("typing"),[F,M]=Object(n.useState)(!1),[D,R]=Object(n.useState)(!1),[x,I]=Object(n.useState)(null),[P,T]=Object(n.useState)(!1),[A,U]=Object(n.useState)(b()),[L,B]=Object(n.useState)(null),[H,J]=Object(n.useState)(!1),[Y,_]=Object(n.useState)(t[s].drawing||null),q=Object(n.useRef)(null),z=Object(n.useRef)(null),G=Object(n.useRef)(!1),[Q,W]=Object(n.useState)(!1),[X,$]=Object(n.useState)("en-US"),[V,Z]=Object(n.useState)(!1),[K,ee]=Object(n.useState)([]),[te,ae]=Object(n.useState)(!1),[ne,le]=Object(n.useState)(!1),[se,oe]=Object(n.useState)([]),[ce,re]=Object(n.useState)(!1),[ie,ue]=Object(n.useState)("Anger"),[me,de]=Object(n.useState)(""),[ge,pe]=Object(n.useState)({Anger:"",Neutral:"",Fear:"",Sadness:"",Surprise:"",Happiness:""}),he=(Object(n.useCallback)(()=>{const a=e.slice(0,14).filter(e=>{const a=t[e];return a&&a.mood>=85});oe(a)},[e,t]),e=>{$(e),Z(!1),ve(e)});Object(n.useEffect)(()=>{(S>=34&&S<=50||S>=51&&S<=67)&&we()},[S]);const be=Object(n.useCallback)(()=>{const a=e.slice(0,14),n=b();let l=0,s=0;a.forEach(e=>{const a=t[e];if(a&&null!==a.mood){const e=Math.floor(a.mood/(100/m.length)),t=m[e];t&&(n[t]+=1,"Sadness"===t?l+=1:"Fear"===t&&(s+=1))}}),U(n);const o=new Date,c=L?Math.floor((o-L)/864e5):8;(l>7||s>7)&&c>=7&&(T(!0),B(new Date))},[e,t,L]);Object(n.useEffect)(()=>{be()},[t,be]),Object(n.useEffect)(()=>{const e=Math.min(Math.floor(S/100*m.length),m.length-1),t=m[e]||"Neutral",a=ge[t]||{Anger:"https://www.youtube.com/watch?v=r8OipmKFDeM",Neutral:"https://www.youtube.com/watch?v=CFGLoQIhmow&t=2486s",Fear:"https://www.youtube.com/watch?v=P_tsPLT0irs",Sadness:"https://www.youtube.com/watch?v=A_MjCqQoLLA",Surprise:"https://www.youtube.com/watch?v=HQmmM_qwG4k&t=2s",Happiness:"https://www.youtube.com/watch?v=ZbZSe6N_BXs"}[t];I({title:t+" Playlist",playlistUrl:a})},[S,ge]),Object(n.useEffect)(()=>{localStorage.setItem("diaryEntries",JSON.stringify(t))},[t]),Object(n.useEffect)(()=>{localStorage.setItem("moodAnalysis",JSON.stringify(A))},[A]),Object(n.useEffect)(()=>{localStorage.setItem("customPlaylists",JSON.stringify(ge))},[ge]),Object(n.useEffect)(()=>{const e=localStorage.getItem("diaryEntries");e&&a(JSON.parse(e));const t=localStorage.getItem("moodAnalysis");t&&U(JSON.parse(t));const n=localStorage.getItem("customPlaylists");n&&pe(JSON.parse(n))},[]),Object(n.useEffect)(()=>{localStorage.setItem("selectedDate",s)},[s]),Object(n.useEffect)(()=>{const e=localStorage.getItem("selectedDate");e&&o(e)},[]);const Ee=e=>{k(e),Q&&fe(),k(e),"speech"===e&&Z(!0),k(e),"speech"===e?ve():fe(),J("draw"===e)},ve=e=>{if(!("webkitSpeechRecognition"in window))return void alert("Speech recognition is not supported in this browser.");const t=new window.webkitSpeechRecognition;t.lang=e,t.interimResults=!1,t.continuous=!0,q.current=t;let a="";t.onresult=e=>{let t="";for(let a=e.resultIndex;a<e.results.length;a++){const n=e.results[a];n.isFinal&&(t+=n[0].transcript.trim())}t&&t!==a&&(y(e=>e+" "+t),a=t)},t.onerror=e=>{console.error("Speech recognition error:",e.error)},t.start(),W(!0)},fe=()=>{q.current&&(q.current.stop(),W(!1))},we=()=>{const a=e.slice(0,14).filter(e=>{const a=t[e];return a&&a.mood>=85});a.length>0&&(ee(a),ae(!0))};return Object(n.useEffect)(()=>{S<51&&we()},[S]),l.a.createElement("div",{className:"app-layout"},l.a.createElement("div",{className:"sidebar"},l.a.createElement("h2",{className:"sidebar-title"},"Diary AI"),l.a.createElement("ul",{className:"diary-list"},e.map((e,n)=>l.a.createElement("li",{key:e,className:"diary-item "+(e===s?"active":""),onClick:()=>(e=>{var n,l,c,r,i;a(e=>({...e,[s]:{...e[s],description:v,mood:S,imageUrl:N,drawing:Y,speechResult:w}})),o(e),f((null===(n=t[e])||void 0===n?void 0:n.description)||""),C((null===(l=t[e])||void 0===l?void 0:l.mood)||25),O((null===(c=t[e])||void 0===c?void 0:c.imageUrl)||null),_((null===(r=t[e])||void 0===r?void 0:r.drawing)||null),y((null===(i=t[e])||void 0===i?void 0:i.speechResult)||"")})(e)},0===n?"Today":e)))),l.a.createElement("div",{className:"main-content"},l.a.createElement("h1",{className:"main-title"},s,"'s Mood"),l.a.createElement("div",{className:"input-icons"},l.a.createElement(c.a,{className:"input-icon "+("typing"===j?"active":""),title:"Type",onClick:()=>Ee("typing")}),l.a.createElement(c.b,{className:"input-icon "+("speech"===j?"active":""),title:"Voice to Text",onClick:()=>Ee("speech")}),l.a.createElement(c.c,{className:"input-icon "+("draw"===j?"active":""),title:"Draw",onClick:()=>{Ee("draw"),J(!0)}})),V&&l.a.createElement("div",{className:"language-modal"},l.a.createElement("h3",null,"Choose Language for Speech-to-Text"),l.a.createElement("button",{onClick:()=>he("en-US")},"English"),l.a.createElement("button",{onClick:()=>he("zh-TW")},"Taiwanese")),"typing"===j&&l.a.createElement("textarea",{className:"description-input",value:v,onChange:e=>f(e.target.value),placeholder:"Write your description here..."}),"speech"===j&&l.a.createElement("div",{className:"speech-result"},l.a.createElement("h3",null,"Speech-to-Text Result"),l.a.createElement("p",null,w)),l.a.createElement("div",{className:"button-container"},l.a.createElement("button",{className:"button enter-button",onClick:()=>{if("speech"===j)Q?(fe(),a(e=>({...e,[s]:{...e[s],speechResult:w}})),alert("Recording stopped and entry saved successfully!")):(ve(),alert("Recording started..."));else{const e=function(e){e=Math.max(0,Math.min(100,e));const t=Math.min(Math.floor(e/100*m.length),m.length-1),a=m[t]||"Neutral",n=p[a]||1;return`/Moodify-Journal/${g[a]}/image${Math.floor(Math.random()*n)+1}.jpg`}(S);O(e),a(t=>({...t,[s]:{description:v,mood:S,imageUrl:e,speechResult:w}})),alert("Entry saved successfully!")}}},"Enter"),l.a.createElement("button",{className:"button clear-button",onClick:()=>{"typing"===j?f(""):"speech"===j&&y("")}},"Clear"),l.a.createElement("button",{className:"button customize-playlist-button",onClick:()=>re(!0)},"Music")),l.a.createElement(E,{isOpen:ce,onClose:()=>re(!1),onSave:(e,t)=>{pe(a=>({...a,[e]:t})),re(!1),de("")},selectedMoodForPlaylist:ie,setSelectedMoodForPlaylist:ue,youtubeLink:me,setYoutubeLink:de}),l.a.createElement("div",{className:"image-display"},N?l.a.createElement("img",{src:N,alt:"Mood",className:"generated-image"}):l.a.createElement("div",{className:"placeholder"},"Your image will appear here")),l.a.createElement("div",{className:"mood-slider-container"},l.a.createElement("div",{className:"mood-emojis"},d.map((e,t)=>l.a.createElement("span",{key:t,className:"mood-emoji"},e))),l.a.createElement("input",{type:"range",min:"0",max:"100",value:S,className:"mood-slider",onChange:a=>(a=>{if(C(a),a>=34&&a<=50||a>=51&&a<=67){const a=e.slice(0,14).filter(e=>{const a=t[e];return a&&a.mood>=85});a.length>0?(oe(a),le(!0)):le(!1)}else le(!1)})(Number(a.target.value))})),x&&l.a.createElement("div",{className:"music-suggestion"},l.a.createElement("h3",null,"Suggested Playlist:"),l.a.createElement("a",{href:x.playlistUrl,target:"_blank",rel:"noopener noreferrer"},l.a.createElement("img",{src:`https://img.youtube.com/vi/${h(x.playlistUrl)}/hqdefault.jpg`,alt:x.title+" playlist",className:"music-thumbnail"}))),l.a.createElement("div",{className:"mood-analysis"},l.a.createElement("h3",null,"Past 14 Days Mood Analysis"),l.a.createElement("ul",null,Object.keys(A).map((e,t)=>l.a.createElement("li",{key:e},m[t]," ",d[t],": ",A[e])))),l.a.createElement(r,{isOpen:P,onClose:()=>T(!1),message:"It seems that you've been feeling fear or sadness for more than 7 days in the past two weeks. Consider talking to a psychiatrist.",link:"https://www.google.com/search?q=%E5%BF%83%E7%90%86%E9%86%AB%E7%94%9F"})),l.a.createElement(i,{isOpen:H,onClose:()=>J(!1),canvasRef:z,handleCanvasMouseDown:e=>{const t=z.current;if(t){const a=t.getContext("2d"),n=t.getBoundingClientRect(),l=t.width/n.width,s=t.height/n.height;a.beginPath(),a.moveTo((e.clientX-n.left)*l,(e.clientY-n.top)*s),G.current=!0}},handleCanvasMouseMove:e=>{if(!G.current)return;const t=z.current;if(t){const a=t.getContext("2d"),n=t.getBoundingClientRect(),l=t.width/n.width,s=t.height/n.height;a.lineTo((e.clientX-n.left)*l,(e.clientY-n.top)*s),a.stroke()}},handleCanvasMouseUp:()=>{G.current=!1},saveDrawing:()=>{const e=z.current;if(e){const t=e.toDataURL();_(t),a(e=>({...e,[s]:{...e[s],drawing:t}})),alert("Drawing saved successfully!")}},reimagineDrawing:()=>{const e=z.current;if(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}_(null),a(e=>({...e,[s]:{...e[s],drawing:null}})),alert("The drawing has been cleared for re-imagining!")},savedDrawing:Y}),ne&&l.a.createElement(u,{isOpen:ne,onClose:()=>le(!1),happyDays:se,onSelectDate:e=>{o(e),le(!1)}}))};var f=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,18)).then(t=>{let{getCLS:a,getFID:n,getFCP:l,getLCP:s,getTTFB:o}=t;a(e),n(e),l(e),s(e),o(e)})};o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(v,null)),document.getElementById("root")),f()}],[[4,1,2]]]);
//# sourceMappingURL=main.4b5a2938.chunk.js.map